ğŸ”„ Starting webhook event processing...
ğŸ¯ [live-test-1750199771] Processing webhook: chats-update -> chats.update [1751311849789-ze9ded21w]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPDATE              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    RELIABILITY ID: 1751311849789-ze9ded21w   !!!
!!!    DATA TYPE: object                      !!!
!!!    RAW EVENT: chats-update                !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: chats.update
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPDATE              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ”                    CHAT MAPPING ANALYSIS                     ğŸ”
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ” INSTANCE NAME: live-test-1750199771
ğŸ” RAW CHAT TYPE: object
ğŸ” FULL RAW CHAT PAYLOAD:
{
    "remoteJid": "5215579188699@s.whatsapp.net",
    "instanceId": "c5215849-bfb9-413c-aa94-dfa911c8310a"
}
ğŸ”
ğŸ” ID FIELD ANALYSIS:
ğŸ”   - rawChat.id: undefined
ğŸ”   - rawChat.remoteJid: 5215579188699@s.whatsapp.net
ğŸ”   - rawChat.chatId: undefined
ğŸ”   - rawChat.key?.remoteJid: undefined
ğŸ”   - rawChat.key: undefined
ğŸ”
ğŸ” ALL CHAT PAYLOAD KEYS: [ 'remoteJid', 'instanceId' ]
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ¯ EXTRACTED CHAT ID: 5215579188699@s.whatsapp.net
ğŸ¯ CHAT ID TYPE: string
ğŸ¯ INSTANCE NAME: live-test-1750199771
ğŸ¯ INSTANCE NAME TYPE: string
âŒ [live-test-1750199771] Processing failed: TypeError: storage.getWhatsappContact is not a function
    at Object.mapApiPayloadToWhatsappChat (/home/runner/workspace/server/whatsapp-api-adapter.ts:1736:51)
    at Object.handleChatsUpsert (/home/runner/workspace/server/whatsapp-api-adapter.ts:419:42)
    at Object.processIncomingEvent (/home/runner/workspace/server/whatsapp-api-adapter.ts:99:28)
    at Object.handleIncomingEvent (/home/runner/workspace/server/webhook-controller.ts:61:31)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:3537:5)
POST /api/evolution/webhook/live-test-1750199771/messages-upsert 200 
ğŸ“¥ Webhook event 1751311849791-pi0xf63yk captured for live-test-1750199771:chats-upsert
ğŸ¯ [live-test-1750199771] Processing webhook: chats-upsert -> chats.upsert [1751311849791-pi0xf63yk]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPSERT              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    RELIABILITY ID: 1751311849791-pi0xf63yk   !!!
!!!    DATA TYPE: object                      !!!
!!!    RAW EVENT: chats-upsert                !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: chats.upsert
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPSERT              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ”                    CHAT MAPPING ANALYSIS                     ğŸ”
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ” INSTANCE NAME: live-test-1750199771
ğŸ” RAW CHAT TYPE: object
ğŸ” FULL RAW CHAT PAYLOAD:
{
    "id": "cmc13toqj07nwry4qwywst4xt",
    "name": "Fer"
}
ğŸ”
ğŸ” ID FIELD ANALYSIS:
ğŸ”   - rawChat.id: cmc13toqj07nwry4qwywst4xt
ğŸ”   - rawChat.remoteJid: undefined
ğŸ”   - rawChat.chatId: undefined
ğŸ”   - rawChat.key?.remoteJid: undefined
ğŸ”   - rawChat.key: undefined
ğŸ”
ğŸ” ALL CHAT PAYLOAD KEYS: [ 'id', 'name' ]
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ¯ EXTRACTED CHAT ID: cmc13toqj07nwry4qwywst4xt
ğŸ¯ CHAT ID TYPE: string
ğŸ¯ INSTANCE NAME: live-test-1750199771
ğŸ¯ INSTANCE NAME TYPE: string
ğŸš¨ğŸš¨ğŸš¨ MALFORMED CHAT ID DETECTED ğŸš¨ğŸš¨ğŸš¨
ğŸš¨ Malformed ID: "cmc13toqj07nwry4qwywst4xt"
ğŸš¨ Length: 25
ğŸš¨ Contains @: false
ğŸš¨ Raw chat data causing malformation:
{
  "id": "cmc13toqj07nwry4qwywst4xt",
  "name": "Fer"
}
ğŸ”§ Attempting to correct malformed chat ID: cmc13toqj07nwry4qwywst4xt
âš ï¸ Evolution API internal ID detected: cmc13toqj07nwry4qwywst4xt
âš ï¸ This requires API lookup to resolve to proper WhatsApp JID
ğŸ”§ Attempting to find JID by contact name: "Fer"
âŒ Error finding contact by name: storage.findWhatsappContactsByName is not a function
âŒ Cannot resolve Evolution API internal ID: cmc13toqj07nwry4qwywst4xt
âŒ Could not find correct chat JID, skipping chat creation
âŒ All available fields in rawChat: [ 'id', 'name' ]
âŒâŒâŒ FAILED TO MAP CHAT 1 âŒâŒâŒ
âŒ Original raw chat that failed mapping:
{
  "id": "cmc13toqj07nwry4qwywst4xt",
  "name": "Fer"
}
âŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒâŒ
ğŸ’¾ Captured failed message for recovery: live-test-1750199771-1751311849822-s45z7vr88
ğŸ’¾ [live-test-1750199771] Captured failed event for recovery: chats-update
ğŸ“¥ Webhook event 1751311849824-cx2682nik captured for live-test-1750199771:messages-upsert
ğŸ¯ [live-test-1750199771] Processing webhook: messages-upsert -> messages.upsert [1751311849824-cx2682nik]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: MESSAGES.UPSERT           !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    RELIABILITY ID: 1751311849824-cx2682nik   !!!
!!!    DATA TYPE: object                      !!!
!!!    RAW EVENT: messages-upsert             !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: messages.upsert
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: MESSAGES.UPSERT           !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ¯ About to process messages.upsert event for instance live-test-1750199771
ğŸ¯ Routing to handleMessageUpsert for regular message
ğŸš€ [live-test-1750199771] handleMessageUpsert called with data type: object
ğŸš€ [live-test-1750199771] Data contains: key, pushName, status, message, messageType, messageTimestamp, instanceId, source
ğŸš€ [live-test-1750199771] Processing 1 messages
ğŸš€ [live-test-1750199771] First message structure: {
  "key": {
    "remoteJid": "5215579188699@s.whatsapp.net",
    "fromMe": true,
    "id": "3A1D4E11C4A4CB443FAA"
  },
  "pushName": "Fer",
  "status": "SERVER_ACK",
  "message": {
    "conversation": "Test 40"
  },
  "messageType": "conversation",
  "messageTimestamp": 1751311849,
  "instanceId": "c5215849-bfb9-413c-aa94-dfa911c8310a",
  "source": "ios"
}
ğŸš€ [live-test-1750199771] First message has key: true
ğŸ”„ [live-test-1750199771] Processing message 3A1D4E11C4A4CB443FAA
ğŸ”„ [live-test-1750199771] Message has reaction: false
ğŸ”„ [live-test-1750199771] Continuing with regular message processing
ğŸ”§ [live-test-1750199771] About to map raw message to clean message
âŒ CRITICAL ERROR in handleMessageUpsert for 3A1D4E11C4A4CB443FAA: TypeError: storage.getWhatsappInstance is not a function
    at detectFromMe (/home/runner/workspace/server/whatsapp-api-adapter.ts:1264:44)
    at Object.mapApiPayloadToWhatsappMessage (/home/runner/workspace/server/whatsapp-api-adapter.ts:1298:39)
    at Object.handleMessageUpsert (/home/runner/workspace/server/whatsapp-api-adapter.ts:222:49)
    at Object.processIncomingEvent (/home/runner/workspace/server/whatsapp-api-adapter.ts:75:32)
    at Object.handleIncomingEvent (/home/runner/workspace/server/webhook-controller.ts:61:31)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:3537:5)
âŒ Error stack: TypeError: storage.getWhatsappInstance is not a function
    at detectFromMe (/home/runner/workspace/server/whatsapp-api-adapter.ts:1264:44)
    at Object.mapApiPayloadToWhatsappMessage (/home/runner/workspace/server/whatsapp-api-adapter.ts:1298:39)
    at Object.handleMessageUpsert (/home/runner/workspace/server/whatsapp-api-adapter.ts:222:49)
    at Object.processIncomingEvent (/home/runner/workspace/server/whatsapp-api-adapter.ts:75:32)
    at Object.handleIncomingEvent (/home/runner/workspace/server/webhook-controller.ts:61:31)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:3537:5)
âŒ Error details: {}
ğŸ¯ Finished processing messages.upsert event
âœ… Webhook event 1751311849789-ze9ded21w processed successfully
âœ… Webhook event 1751311849791-pi0xf63yk processed successfully
âœ… Webhook event 1751311849824-cx2682nik processed successfully
âœ… Webhook event processing completed
POST /api/evolution/webhook/live-test-1750199771/contacts-update 200 
ğŸ“¥ Webhook event 1751311849905-1ulrvdiva captured for live-test-1750199771:contacts-update
ğŸ”„ Starting webhook event processing...
ğŸ¯ [live-test-1750199771] Processing webhook: contacts-update -> contacts.update [1751311849905-1ulrvdiva]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CONTACTS.UPDATE           !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    RELIABILITY ID: 1751311849905-1ulrvdiva   !!!
!!!    DATA TYPE: object                      !!!
!!!    RAW EVENT: contacts-update             !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: contacts.update
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CONTACTS.UPDATE           !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
âœ… Webhook event 1751311849905-1ulrvdiva processed successfully
âœ… Webhook event processing completed
âœ… [live-test-1750199771] Contact upserted: 5215579188699@s.whatsapp.net
POST /api/evolution/webhook/live-test-1750199771/messages-update 200 
ğŸ“¥ Webhook event 1751311850782-tmodhu6sz captured for live-test-1750199771:messages-update
ğŸ”„ Starting webhook event processing...
ğŸ¯ [live-test-1750199771] Processing webhook: messages-update -> messages.update [1751311850782-tmodhu6sz]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: MESSAGES.UPDATE           !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    RELIABILITY ID: 1751311850782-tmodhu6sz   !!!
!!!    DATA TYPE: object                      !!!
!!!    RAW EVENT: messages-update             !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: messages.update
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: MESSAGES.UPDATE           !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
âœ… Webhook event 1751311850782-tmodhu6sz processed successfully
âœ… Webhook event processing completed
POST /api/evolution/webhook/live-test-1750199771/chats-upsert 200 
ğŸ“¥ Webhook event 1751311850787-1p70tdcet captured for live-test-1750199771:chats-upsert
ğŸ”„ Starting webhook event processing...
ğŸ¯ [live-test-1750199771] Processing webhook: chats-upsert -> chats.upsert [1751311850787-1p70tdcet]
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPSERT              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    RELIABILITY ID: 1751311850787-1p70tdcet   !!!
!!!    DATA TYPE: object                      !!!
!!!    RAW EVENT: chats-upsert                !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: chats.upsert
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPSERT              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ”                    CHAT MAPPING ANALYSIS                     ğŸ”
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ” INSTANCE NAME: live-test-1750199771
ğŸ” RAW CHAT TYPE: object
ğŸ” FULL RAW CHAT PAYLOAD:
{
    "remoteJid": "5215579188699@s.whatsapp.net",
    "instanceId": "c5215849-bfb9-413c-aa94-dfa911c8310a",
    "name": "",
    "unreadMessages": 0
}
ğŸ”
ğŸ” ID FIELD ANALYSIS:
ğŸ”   - rawChat.id: undefined
ğŸ”   - rawChat.remoteJid: 5215579188699@s.whatsapp.net
ğŸ”   - rawChat.chatId: undefined
ğŸ”   - rawChat.key?.remoteJid: undefined
ğŸ”   - rawChat.key: undefined
ğŸ”
ğŸ” ALL CHAT PAYLOAD KEYS: [ 'remoteJid', 'instanceId', 'name', 'unreadMessages' ]
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ¯ EXTRACTED CHAT ID: 5215579188699@s.whatsapp.net
ğŸ¯ CHAT ID TYPE: string
ğŸ¯ INSTANCE NAME: live-test-1750199771
ğŸ¯ INSTANCE NAME TYPE: string
âŒ [live-test-1750199771] Processing failed: TypeError: storage.getWhatsappContact is not a function
    at Object.mapApiPayloadToWhatsappChat (/home/runner/workspace/server/whatsapp-api-adapter.ts:1736:51)
    at Object.handleChatsUpsert (/home/runner/workspace/server/whatsapp-api-adapter.ts:419:42)
    at Object.processIncomingEvent (/home/runner/workspace/server/whatsapp-api-adapter.ts:99:28)
    at Object.handleIncomingEvent (/home/runner/workspace/server/webhook-controller.ts:61:31)
    at async <anonymous> (/home/runner/workspace/server/routes.ts:3537:5)
ğŸ’¾ Captured failed message for recovery: live-test-1750199771-1751311850796-diy9eank9
ğŸ’¾ [live-test-1750199771] Captured failed event for recovery: chats-upsert
âœ… Webhook event 1751311850787-1p70tdcet processed successfully
âœ… Webhook event processing completed
ğŸ”„ Attempting recovery for message: live-test-1750199771-1751311849822-s45z7vr88
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: chats.upsert
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPSERT              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ”                    CHAT MAPPING ANALYSIS                     ğŸ”
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ” INSTANCE NAME: live-test-1750199771
ğŸ” RAW CHAT TYPE: object
ğŸ” FULL RAW CHAT PAYLOAD:
{
    "remoteJid": "5215579188699@s.whatsapp.net",
    "instanceId": "c5215849-bfb9-413c-aa94-dfa911c8310a"
}
ğŸ”
ğŸ” ID FIELD ANALYSIS:
ğŸ”   - rawChat.id: undefined
ğŸ”   - rawChat.remoteJid: 5215579188699@s.whatsapp.net
ğŸ”   - rawChat.chatId: undefined
ğŸ”   - rawChat.key?.remoteJid: undefined
ğŸ”   - rawChat.key: undefined
ğŸ”
ğŸ” ALL CHAT PAYLOAD KEYS: [ 'remoteJid', 'instanceId' ]
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ¯ EXTRACTED CHAT ID: 5215579188699@s.whatsapp.net
ğŸ¯ CHAT ID TYPE: string
ğŸ¯ INSTANCE NAME: live-test-1750199771
ğŸ¯ INSTANCE NAME TYPE: string
âŒ Failed to recover chat: TypeError: storage.getWhatsappContact is not a function
    at Object.mapApiPayloadToWhatsappChat (/home/runner/workspace/server/whatsapp-api-adapter.ts:1736:51)
    at Object.handleChatsUpsert (/home/runner/workspace/server/whatsapp-api-adapter.ts:419:42)
    at Object.processIncomingEvent (/home/runner/workspace/server/whatsapp-api-adapter.ts:99:28)
    at MessageRecoverySystem.recoverChat (/home/runner/workspace/server/message-recovery-system.ts:309:31)
    at async MessageRecoverySystem.attemptMessageRecovery (/home/runner/workspace/server/message-recovery-system.ts:161:18)
    at async MessageRecoverySystem.processFailedMessages (/home/runner/workspace/server/message-recovery-system.ts:93:29)
ğŸ”„ Retry 1 scheduled for message: live-test-1750199771-1751311849822-s45z7vr88
ğŸ”„ Attempting recovery for message: live-test-1750199771-1751311850796-diy9eank9
ğŸ” Evolution API provided instanceName: live-test-1750199771
ğŸ“¨ [live-test-1750199771] Translating event: chats.upsert
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!    WEBHOOK EVENT: CHATS.UPSERT              !!!
!!!    INSTANCE: live-test-1750199771           !!!
!!!    DATA TYPE: object                      !!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ”                    CHAT MAPPING ANALYSIS                     ğŸ”
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ” INSTANCE NAME: live-test-1750199771
ğŸ” RAW CHAT TYPE: object
ğŸ” FULL RAW CHAT PAYLOAD:
{
    "remoteJid": "5215579188699@s.whatsapp.net",
    "instanceId": "c5215849-bfb9-413c-aa94-dfa911c8310a",
    "name": "",
    "unreadMessages": 0
}
ğŸ”
ğŸ” ID FIELD ANALYSIS:
ğŸ”   - rawChat.id: undefined
ğŸ”   - rawChat.remoteJid: 5215579188699@s.whatsapp.net
ğŸ”   - rawChat.chatId: undefined
ğŸ”   - rawChat.key?.remoteJid: undefined
ğŸ”   - rawChat.key: undefined
ğŸ”
ğŸ” ALL CHAT PAYLOAD KEYS: [ 'remoteJid', 'instanceId', 'name', 'unreadMessages' ]
ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”ğŸ”
ğŸ¯ EXTRACTED CHAT ID: 5215579188699@s.whatsapp.net
ğŸ¯ CHAT ID TYPE: string
ğŸ¯ INSTANCE NAME: live-test-1750199771
ğŸ¯ INSTANCE NAME TYPE: string
âŒ Failed to recover chat: TypeError: storage.getWhatsappContact is not a function
    at Object.mapApiPayloadToWhatsappChat (/home/runner/workspace/server/whatsapp-api-adapter.ts:1736:51)
    at Object.handleChatsUpsert (/home/runner/workspace/server/whatsapp-api-adapter.ts:419:42)
    at Object.processIncomingEvent (/home/runner/workspace/server/whatsapp-api-adapter.ts:99:28)
    at MessageRecoverySystem.recoverChat (/home/runner/workspace/server/message-recovery-system.ts:309:31)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async MessageRecoverySystem.attemptMessageRecovery (/home/runner/workspace/server/message-recovery-system.ts:161:18)
    at async MessageRecoverySystem.processFailedMessages (/home/runner/workspace/server/message-recovery-system.ts:93:29)
ğŸ”„ Retry 1 scheduled for message: live-test-1750199771-1751311850796-diy9eank9